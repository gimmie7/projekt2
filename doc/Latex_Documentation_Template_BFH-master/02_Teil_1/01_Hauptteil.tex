\chapter{Übersicht Gesamtsystem}
\label{sec:teil1_uebersicht}

Das System besteht aus einem Smart Meter (EM340) und einem Gateway, auf welchem die Software zur Verbrauchsanalyse installiert ist. Die Geräte sind alle an der Phase L1 des Energiezählers angeschlossen. Prinzipiell ist der hier verwendete Energiezähler  zwar so konzipiert, dass er auf drei verschiedenen Phasen Messungen durchführen könnte, in diesem Projekt wurde aber einfachheitshalber nur die Phase L1 genutzt.


\begin{figure}[H]
	\centering
	\includegraphics[width=1.0\textwidth]{Bilder/uebersicht.png} %70% der Textbreite
	\caption{Übersicht Gesamtsystem}
	\label{fig:teil1_pestle}
\end{figure}

Als Gateway dient hier ein Raspberry Pi, auf welchem das in Python geschriebene Programm läuft,mit welchem die Daten aus dem Zähler gelesen, verarbeitet und an das SIOT gesendet werden. Der Energiezähler stellt verschiedene Register bereit, aus welchen jeweils pro Phase der Stromverbrauch I [A], die Spannung U [V], die Wirk P [W]-, Schein S [VA]- und Blindleistung Q [var] herausgelesen werden können. Diese Werte bilden die Grundlage zur Signaturerstellung der einzelnen Verbraucher.

\chapter{Erstellen von Signaturen der Verbraucher}
\label{sec:teil1_uebersicht}
Aufgrund der physikalischen Gegebenheiten beeinflusst jedes Haushaltsgerät Strom und Spannung auf unterschiedliche weise. Genauer gesagt unterscheidet man zwischen ohmschen-, kapazitiven- und induktiven Verbrauchern. Ohmsche Verbraucher bestehen aus einem oder mehreren Widerständen, d.h. elektrischen Komponenten, die im wesentlichen Hitze oder Licht erzeugen. Beispiele dafür sind der Ofen oder auch Glühbirnen. Beim rein "`ohmschen"' Verbraucher (dem ohne induktiven oder kapazitiven Anteil) sind Spannung und Strom stets "`in Phase"', d.h. es gibt keine Phasenverschiebung und somit keinen Blindleistungsanteil, was gleichzeitig auch bedeutet, dass die Wirkleistung gleich der Scheinleistung entspricht.
 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.3\textwidth]{Bilder/wirk.png} %70% der Textbreite
	\caption{Spannung-/Stromverlauf ohmsche Widerstände, Quelle: www.lernhelfer.de}
	\label{fig:teil1_pestle}
\end{figure}

Induktive Verbraucher sind im wesentlichen elektromagnetische Verbraucher, d.h. elektrische Komponenten, die Elektromagnetismus erzeugen. Diese Geräte benötigen beim Anlauf unter Umständen ein vielfaches an Anlaufstrom. Beispiele dafür sind Pumpen oder auch Ventilatoren. Bei rein induktiven Komponenten eilt die Spannung dem Strom voraus, wodurch sich eine Phasenverschiebung von 90 Grad ergibt. D.h. hier gibt es einen Blindleistungsanteil und somit ist die Wirkleistung ungleich der Scheinleistung.
\begin{figure}[H]
	\centering
	\includegraphics[width=0.3\textwidth]{Bilder/induktiv.png} %70% der Textbreite
	\caption{Spannung-/Stromverlauf induktive Widerstände, Quelle: www.lernhelfer.de}
	\label{fig:teil1_pestle}
\end{figure}

Kapazitive Verbraucher verhalten sich ähnlich wie induktive Verbraucher, mit dem Unterschied, dass hier keine Magnetfelder aufgebaut werden, sondern elektrische Felder. Bei kapazitiven Lasten eilt der Strom der Spannung voraus, wobei auch hier wieder eine Phasenverschiebung von 90 Grad entsteht. D.h. also, dass auch kapazitive Lasten einen Blindleistungsanteil besitzen und die Wirkleistung nicht der Scheinleistung entspricht. 

\begin{figure}[H]
	\centering
	\includegraphics[width=0.3\textwidth]{Bilder/kapazitiv.png} %70% der Textbreite
	\caption{Spannung-/Stromverlauf kapazitive Widerstände, Quelle: www.lernhelfer.de}
	\label{fig:teil1_pestle}
\end{figure}


Allerdings sind rein ohmsche, kapazitive und induktive Verbraucher eher selten und Misch-Verbraucher die Regel. D.h. also dass jeder Verbraucher in unterschiedlicher Weise Wirk-, Blind-, und Scheinleistung beeinflusst. Somit könnten zwei Verbraucher mit gleicher Wirkleistung trotzdem unterschieden werden aufgrund unterschiedlicher Blindleistungsanteilen. 



Um für jedes Haushaltsgerät eine Signatur erstellen zu können, werden die Geräte zu Beginn jeweils einzeln an das Smartmeter angeschlossen und die jeweiligen Register über einen Zeitraum von 30 Sekunden ausgelesen. Die so gewonnenen Daten werden anschliessend in einer Datenbank abgespeichert und einem Gerät eindeutig zugewiesen. Diese Signatur wird dann schlussendlich verwendet um den Gesamtstromverbrauch auf die einzelnen Verbraucher aufschlüsseln zu können. Für diese Projekt 2 Arbeit kamen folgende Haushaltsgeräte zum Einsatz: 

\begin{table}[h]
\begin{center}
	\begin{tabular}{ |l|r| }
	\hline
	\textbf{Gerät} & 
	\textbf{Angegebene Leistung [W]} 
	 \\ 
	\hline
	Stabmixer & 220  \\ \hline
	Toaster & 800  \\ \hline
	Wasserkocher & 1850 - 2200  \\ \hline
	Heizlüfter & 1200 \\ \hline
	Haarföhn & 1800 - 2200 \\ \hline
	Bügeleisen & 2300\\ \hline
	

	\end{tabular}
\end{center}
\caption{Geräte}
\label{table:ergebnisseKombinatorik}
\end{table}


Die zwei nachfolgenden Abbildungen illustrieren zwei Beispielsignaturen.

Der Haarföhn ist ein rein ohmscher Verbraucher und weist somit keinen Blindleistungsanteil auf. Die Wirk- und die Scheinleistung sind somit gleich hoch und überlagern sich in der Grafik.
\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\textwidth]{Bilder/foehn.png} %70% der Textbreite
	\caption{Signatur Haarföhn}
	\label{fig:teil1_pestle}
\end{figure}

\newpage

Der Heizlüfter dagegen ist eine induktive Last. Wie man der Abbildung entnehmen kann besteht hier auch ein gewisser Blindleistungsanteil.
\begin{figure}[H]
	\centering
	\includegraphics[width=0.5\textwidth]{Bilder/Heizluefter.png} %70% der Textbreite
	\caption{Signatur Heizlüfter}
	\label{fig:teil1_pestle}
\end{figure}

\chapter{Disaggregation: NILM Ansätze}
\label{sec:teil1_ansaetze}

\section{Ansatz Kombinatorik}
\label{sec:teil1_kombinatorik}
Beim Ansatz mittels Kombinatorik werden alle möglichen Kombinationen aus den Geräten bzw. deren Signaturen gebildet. Mathematisch ausgedrückt entspricht dies einer Kombination ohne Wiederholung und ohne fixe Anzahl Elemente. Dies führt zu der folgenden Formel:
$$\sum_{k=1}^{n} \binom{n}{k} $$

n entspricht der Anzahl Elemente aus der Auswahlmenge, also der Anzahl Gerätesignaturen, und k entspricht der Anzahl Elemente, aus der die Kombination besteht. Die kleinstmögliche Kombination an Gerätesignaturen ist somit 1 und die grösstmögliche ist n.
\par
Bei beispielsweise vier unterschiedlichen Gerätesignaturen ergibt dies die folgende Anzahl an möglichen Kombinationen:
$$\sum_{k=1}^{n=4} \binom{n}{k} = 15$$

Der Algorithmus zum Herausfinden welche Geräte zu einem bestimmten Zeitpunkt X am Stromzähler angeschlossen sind und Strom verbrauchen, funktioniert folgendermassen: aus den gemessenen Zählerdaten zum Zeitpunkt X wird zu jeder Kombination der Gerätesignaturen die Differenz zwischen Wirkleistung P, Scheinleistung S, Blindleistung Q und Stromverbrauch I berechnet und summiert. Dies entspricht dann der Differenz zwischen einer Kombination und den effektiv gemessenen Messdaten.

\[Differenz = |P_t - P_k| + |S_t - S_k| + |Q_t - Q_k| + |I_t - I_k|\]

Diejenige Kombination mit der kleinsten Differenz zu den effektiven Messdaten wird als Sieger auserkoren.

\section{Ansatz Eventbasiert }
\label{sec:teil1_kombinatorik}
Beim eventbasierten Ansatz werden kontinuierlich Messungen durchgeführt und auf Events reagiert. Die gemessenen Werte werden zwischengespeichert und bei der nächsten Messung wird die Differenz daraus gebildet. Ist die Differenz grösser als der Schwellwert von 25W Wirkleistung, wird dies als ein Event interpretiert. 

\[Differenz = Messung zum Zeitpunkt t1 - Messung zum Zeitpunkt t2\]

Falls diese Differenz positiv ist, entspricht dies einem ON-Event, d.h. Gerät wurde hinzugeschaltet. Falls sie negativ, entspricht dies einem OFF-Event, d.h. Gerät wurde abgeschaltet. Die so ermittelte Differenz wird nun mit allen Gerätesignaturen verglichen. Dasjenige Gerät, dessen Wert am nächsten bei dieser Differenz liegt, wird als das Eventauslösende Gerät identifiziert.

TODO

\[Differenz = |Gerät X - Differenz|\]

\chapter{Ergebnisse}
\label{sec:teil1_kombinatorik}

\section{Ansatz Kobinatorik}
Der Ansatz mittels Kombinatorik funktioniert nicht sehr gut und stösst bald mal an seine Grenzen. Werden jeweils nur die einzelnen Geräte angeschlossen, so werden diese noch alle einwandfrei identifiziert. Bei den Zweier-Kombinationen werden dagegen nur noch rund 80 \% erkannt. Bei den Dreier-Kombinationen treten dann schon die ersten grösseren Probleme auf. 
\begin{itemize}
\item Geräte mit hohem Verbrauch konnten nicht in Kombination getestet werden, da nur eine Phase verwendet wurde. Dies führte auf dieser Phase zu einer Überlast.
\item Der gemessene Verbrauch eines Gerätes ist in Kombination mit anderen Geräten etwas niedriger als wenn das Gerät einzeln gemessen wird. Die Folge davon ist, dass andere Kombinationen teilweise näher am gemessenen Wert liegen als die eigentliche Kombination.
\item Die Anzahl an Kombinationen steigt mit zunehmender Anzahl Verbrauchern enorm an. Sind es bei sieben Geräten noch überschaubare 127 Gerätekombinationen, so sind es bei 20 Geräten bereits 1'048'575 Kombinationen. Dies wirkt sich negativ auf die Performance aus.
\end{itemize}

TODO: Replace Geräte mit Verbraucher

\section{Ansatz Eventbasiert}
Der in dieser Arbeit verwendete eventbasierte Ansatz ist sehr einfach gehalten und funktioniert wohl deshalb auch nicht einwandfrei. Einzelne Verbraucher werden jeweils einwandfrei identifiziert.
\begin{itemize}
\item Verbraucher mit sehr geringem Verbrauch können nicht identifiziert werden aufgrund der kleinen Differenzen. Um diese zu erkennen, müsste der Schwellwert zum Auslösen des Events viel kleiner gewählt werden. Dies würde aber dazu führen, dass kleine Schwankungen auch als Events interpretiert würden.
\item Multistatus-Verbraucher, d.h. Verbraucher mit mehreren Zuständen wie bspw. ein Staubsauger, können nicht erkannt werden, da jeder Zustandswechsel als Event interpretiert würde.
\item Verbraucher mit sehr ähnlichem Verbrauch können nur schwer unterschieden werden.
\end{itemize}

Der eventbasierte Ansatz hat sicher mehr Potential als der kombinatorische Ansatz. Bei Hinzunahme weiterer Features und durch Anpassung des Schwellwertes kann dieser Ansatz noch optimiert werden. Durch Verwendung entsprechender Filter könnten zudem Schwankungen in den Messungen geglättet werden. Durch diese Optimierungen könnten somit weitaus bessere Ergebnisse erzielt werden.

\chapter{Ansatz Machine Learning}
\label{sec:teil1_kombinatorik}
Die zuvor diskutierten Ansätze weisen, wie schon im vorherigen Kapitel erwähnt, noch einige Probleme auf und sind für eine präzise Disaggregation somit nur bedingt geeignet. Es wird ein Modell benötigt, welches robust ist, auch wenn die Anzahl der Geräte erhöht wird. Ausserdem sollten auch Multistatusgeräte klassifiziert werden können, wie beispielsweise ein Staubsauger oder eine Waschmaschine. Und auch Geräte mit ähnlichem Verbrauch sollte das Modell erkennen können. Neuronale Netze sind ein vielversprechender Ansatz dafür. Um NILM mittels Neuronalen Netzen abzubilden, werden allerdings sehr viele Daten benötigt. Trainsingsdatensätze zu diesem Thema gibt es aber schon bereits, einer davon ist REDD. Dieser ist öffentlich verfügbar mit Daten über den Verbrauch von 10 Häusern in der USA, wo das System zweiphasig ist. Es enthält gesampelte Daten in niedriger Frequenz (1 Hz) für das ganze Haus und einzelne Geräte.Im Bereich Machine Learning und Neuronalen Netzen unterscheidet man zwischen drei verschiedenen Lernmethoden:

\textbf{Supervised Learning:}  
Beim überwachten Lernen wird das Modell nicht nur mit dem aggregierten Verbrauch trainiert, sondern auch mit dem Verbrauch der einzelnen Geräte. Somit müssen Daten auf Geräteebene gesammelt werden, die dann als Trainingsdaten für das Modell verwendet werden.

\textbf{Unsupervised Learning:} 
Beim unüberwachtem Lernen wird das Modell nur mit dem aggregierten Verbrauch trainiert, was bedeutet, dass kein vorheriges Training mit gelabelten Daten erforderlich ist. Diese Methode wäre sehr wünschenswert.

\textbf{Semi-Supervised Learning:} 
Beim halb überwachten Lernen verwendet das Modell eine Kombination von sowohl gelabelten als auch ungelabelten Daten für das Training. Im Fall von NILM ist es wohl die am besten geeignete Methode.

Das Neuronale Netz wird jeweils mit einem Trainingsdatensatz trainiert und dann auf Daten getestet, die das Netz noch nie zuvor gesehen hat.










\chapter{Schlusswort}
\label{sec:teil1_kombinatorik}
Die ganze Thematik rund um NILM ist sehr aktuell und hat viel Potential. 


Fazit, Schwierigkeiten, Ausblick Thesis
% Einträge im Verzeichnis erscheinen lassen ohne hier eine Referenz einzufügen
\nocite{kopka:band1}
\nocite{raichle:bibtex_programmierung}
\nocite{MiKTeX}
\nocite{KOMA}
\nocite{TeXnicCenter}
\nocite{Marti06}
\nocite{Erbsland08}
\nocite{juergens:einfuehrung}
\nocite{juergens:fortgeschritten}









